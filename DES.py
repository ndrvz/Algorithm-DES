S_BOX1 = {}
S_BOX1["000000"] = "1110" 
S_BOX1["000010"] = "0100" 
S_BOX1["000100"] = "1101" 
S_BOX1["000110"] = "0001" 
S_BOX1["001000"] = "0010" 
S_BOX1["001010"] = "1111" 
S_BOX1["001100"] = "1011" 
S_BOX1["001110"] = "1000" 
S_BOX1["010000"] = "0011" 
S_BOX1["010010"] = "1010" 
S_BOX1["010100"] = "0110" 
S_BOX1["010110"] = "1100" 
S_BOX1["011000"] = "0101"
S_BOX1["011010"] = "1001" 
S_BOX1["011100"] = "0000" 
S_BOX1["011110"] = "0111" 

S_BOX1["000001"] = "0000" 
S_BOX1["000011"] = "1111" 
S_BOX1["000101"] = "0111"
S_BOX1["000111"] = "0100"
S_BOX1["001001"] = "1110"
S_BOX1["001011"] = "0010"
S_BOX1["001101"] = "1101"
S_BOX1["001111"] = "0001"
S_BOX1["010001"] = "1010"
S_BOX1["010011"] = "0110"
S_BOX1["010101"] = "1100"
S_BOX1["010111"] = "1011"
S_BOX1["011001"] = "1001"
S_BOX1["011011"] = "0101"
S_BOX1["011101"] = "0011"
S_BOX1["011111"] = "1000"

S_BOX1["100000"] = "0100"
S_BOX1["100010"] = "0001"
S_BOX1["100100"] = "1110"
S_BOX1["100110"] = "1000"
S_BOX1["101000"] = "1101"
S_BOX1["101010"] = "0110"
S_BOX1["101100"] = "0010"
S_BOX1["101110"] = "1011"
S_BOX1["110000"] = "1111"
S_BOX1["110010"] = "1100"
S_BOX1["110100"] = "1001"
S_BOX1["110110"] = "0111"
S_BOX1["111000"] = "0011"
S_BOX1["111010"] = "1010"
S_BOX1["111100"] = "0101"
S_BOX1["111110"] = "0000"

S_BOX1["100001"] = "1111"
S_BOX1["100011"] = "1100"
S_BOX1["100101"] = "1000"
S_BOX1["100111"] = "0010"
S_BOX1["101001"] = "0100"
S_BOX1["101011"] = "1001"
S_BOX1["101101"] = "0001"
S_BOX1["101111"] = "0111"
S_BOX1["110001"] = "0101"
S_BOX1["110011"] = "1011"
S_BOX1["110101"] = "0011"
S_BOX1["110111"] = "1110"
S_BOX1["111001"] = "1010"
S_BOX1["111011"] = "0000"
S_BOX1["111101"] = "0110"
S_BOX1["111111"] = "1101"

S_BOX2 = {}
S_BOX2["000000"] = "1111"
S_BOX2["000010"] = "0001"
S_BOX2["000100"] = "1000"
S_BOX2["000110"] = "1110"
S_BOX2["001000"] = "0110"
S_BOX2["001010"] = "1011"
S_BOX2["001100"] = "0011"
S_BOX2["001110"] = "0100"
S_BOX2["010000"] = "1001"
S_BOX2["010010"] = "0111"
S_BOX2["010100"] = "0010"
S_BOX2["010110"] = "1101"
S_BOX2["011000"] = "1100"
S_BOX2["011010"] = "0000"
S_BOX2["011100"] = "0101"
S_BOX2["011110"] = "1010"

S_BOX2["000001"] = "0011"
S_BOX2["000011"] = "1101"
S_BOX2["000101"] = "0100"
S_BOX2["000111"] = "0111"
S_BOX2["001001"] = "1111"
S_BOX2["001011"] = "0010"
S_BOX2["001101"] = "1000"
S_BOX2["001111"] = "1110"
S_BOX2["010001"] = "1100"
S_BOX2["010011"] = "0000"
S_BOX2["010101"] = "0001"
S_BOX2["010111"] = "1010"
S_BOX2["011001"] = "0110"
S_BOX2["011011"] = "1001"
S_BOX2["011101"] = "1011"
S_BOX2["011111"] = "0101"

S_BOX2["100000"] = "0000"
S_BOX2["100010"] = "1110"
S_BOX2["100100"] = "0111"
S_BOX2["100110"] = "1011"
S_BOX2["101000"] = "1010"
S_BOX2["101010"] = "0100"
S_BOX2["101100"] = "1101"
S_BOX2["101110"] = "0001"
S_BOX2["110000"] = "0101"
S_BOX2["110010"] = "1000"
S_BOX2["110100"] = "1100"
S_BOX2["110110"] = "0110"
S_BOX2["111000"] = "1001"
S_BOX2["111010"] = "0011"
S_BOX2["111100"] = "0010"
S_BOX2["111110"] = "1111"

S_BOX2["100001"] = "1101"
S_BOX2["100011"] = "1000"
S_BOX2["100101"] = "1010"
S_BOX2["100111"] = "0001"
S_BOX2["101001"] = "0011"
S_BOX2["101011"] = "1111"
S_BOX2["101101"] = "0100"
S_BOX2["101111"] = "0010"
S_BOX2["110001"] = "1011"
S_BOX2["110011"] = "0110"
S_BOX2["110101"] = "0111"
S_BOX2["110111"] = "1100"
S_BOX2["111001"] = "0000"
S_BOX2["111011"] = "0101"
S_BOX2["111101"] = "1110"
S_BOX2["111111"] = "1001"

S_BOX3 = {}
S_BOX3["000000"] = "1010"
S_BOX3["000010"] = "0000"
S_BOX3["000100"] = "1001"
S_BOX3["000110"] = "1110"
S_BOX3["001000"] = "0110"
S_BOX3["001010"] = "0011"
S_BOX3["001100"] = "1111"
S_BOX3["001110"] = "0101"
S_BOX3["010000"] = "0001"
S_BOX3["010010"] = "1101"
S_BOX3["010100"] = "1100"
S_BOX3["010110"] = "0111"
S_BOX3["011000"] = "1011"
S_BOX3["011010"] = "0100"
S_BOX3["011100"] = "0010"
S_BOX3["011110"] = "1000"

S_BOX3["000001"] = "1101"
S_BOX3["000011"] = "0111"
S_BOX3["000101"] = "0000"
S_BOX3["000111"] = "1001"
S_BOX3["001001"] = "0011"
S_BOX3["001011"] = "0100"
S_BOX3["001101"] = "0110"
S_BOX3["001111"] = "1010"
S_BOX3["010001"] = "0010"
S_BOX3["010011"] = "1000"
S_BOX3["010101"] = "0101"
S_BOX3["010111"] = "1110"
S_BOX3["011001"] = "1100"
S_BOX3["011011"] = "1011"
S_BOX3["011101"] = "1111"
S_BOX3["011111"] = "0001"

S_BOX3["100000"] = "1101"
S_BOX3["100010"] = "0110"
S_BOX3["100100"] = "0100"
S_BOX3["100110"] = "1001"
S_BOX3["101000"] = "1000"
S_BOX3["101010"] = "1111"
S_BOX3["101100"] = "0011"
S_BOX3["101110"] = "0000"
S_BOX3["110000"] = "1011"
S_BOX3["110010"] = "0001"
S_BOX3["110100"] = "0010"
S_BOX3["110110"] = "1100"
S_BOX3["111000"] = "0101"
S_BOX3["111010"] = "1010"
S_BOX3["111100"] = "1110"
S_BOX3["111110"] = "0111"

S_BOX3["100001"] = "0001"
S_BOX3["100011"] = "1010"
S_BOX3["100101"] = "1101"
S_BOX3["100111"] = "0000"
S_BOX3["101001"] = "0110"
S_BOX3["101011"] = "1001"
S_BOX3["101101"] = "1000"
S_BOX3["101111"] = "0111"
S_BOX3["110001"] = "0100"
S_BOX3["110011"] = "1111"
S_BOX3["110101"] = "1110"
S_BOX3["110111"] = "0011"
S_BOX3["111001"] = "1011"
S_BOX3["111011"] = "0101"
S_BOX3["111101"] = "0010"
S_BOX3["111111"] = "1100"


S_BOX4 = {}
S_BOX4["000000"] = "0111"
S_BOX4["000010"] = "1101"
S_BOX4["000100"] = "1110"
S_BOX4["000110"] = "0011"
S_BOX4["001000"] = "0000"
S_BOX4["001010"] = "0110"
S_BOX4["001100"] = "1001"
S_BOX4["001110"] = "1010"
S_BOX4["010000"] = "0001"
S_BOX4["010010"] = "0010"
S_BOX4["010100"] = "1000"
S_BOX4["010110"] = "0101"
S_BOX4["011000"] = "1011"
S_BOX4["011010"] = "1100"
S_BOX4["011100"] = "0100"
S_BOX4["011110"] = "1111"

S_BOX4["000001"] = "1101"
S_BOX4["000011"] = "1000"
S_BOX4["000101"] = "1011"
S_BOX4["000111"] = "0101"
S_BOX4["001001"] = "0110"
S_BOX4["001011"] = "1111"
S_BOX4["001101"] = "0000"
S_BOX4["001111"] = "0011"
S_BOX4["010001"] = "0100"
S_BOX4["010011"] = "0111"
S_BOX4["010101"] = "0010"
S_BOX4["010111"] = "1100"
S_BOX4["011001"] = "0001"
S_BOX4["011011"] = "1010"
S_BOX4["011101"] = "1110"
S_BOX4["011111"] = "1001"

S_BOX4["100000"] = "1010"
S_BOX4["100010"] = "0110"
S_BOX4["100100"] = "1001"
S_BOX4["100110"] = "0000"
S_BOX4["101000"] = "1100"
S_BOX4["101010"] = "1011"
S_BOX4["101100"] = "0111"
S_BOX4["101110"] = "1101"
S_BOX4["110000"] = "1111"
S_BOX4["110010"] = "0001"
S_BOX4["110100"] = "0011"
S_BOX4["110110"] = "1110"
S_BOX4["111000"] = "0101"
S_BOX4["111010"] = "0010"
S_BOX4["111100"] = "1000"
S_BOX4["111110"] = "0100"

S_BOX4["100001"] = "0011"
S_BOX4["100011"] = "1111"
S_BOX4["100101"] = "0000"
S_BOX4["100111"] = "0110"
S_BOX4["101001"] = "1010"
S_BOX4["101011"] = "0001"
S_BOX4["101101"] = "1101"
S_BOX4["101111"] = "1000"
S_BOX4["110001"] = "1001"
S_BOX4["110011"] = "0100"
S_BOX4["110101"] = "0101"
S_BOX4["110111"] = "1011"
S_BOX4["111001"] = "1100"
S_BOX4["111011"] = "0111"
S_BOX4["111101"] = "0010"
S_BOX4["111111"] = "1110"

S_BOX5 = {}
S_BOX5["000000"] = "0010"
S_BOX5["000010"] = "1100"
S_BOX5["000100"] = "0100"
S_BOX5["000110"] = "0001"
S_BOX5["001000"] = "0111"
S_BOX5["001010"] = "1010"
S_BOX5["001100"] = "1011"
S_BOX5["001110"] = "0110"
S_BOX5["010000"] = "1000"
S_BOX5["010010"] = "0101"
S_BOX5["010100"] = "0011"
S_BOX5["010110"] = "1111"
S_BOX5["011000"] = "1101"
S_BOX5["011010"] = "0000"
S_BOX5["011100"] = "1110"
S_BOX5["011110"] = "1001"

S_BOX5["000001"] = "1110"
S_BOX5["000011"] = "1011"
S_BOX5["000101"] = "0010"
S_BOX5["000111"] = "1100"
S_BOX5["001001"] = "0100"
S_BOX5["001011"] = "0111"
S_BOX5["001101"] = "1101"
S_BOX5["001111"] = "0001"
S_BOX5["010001"] = "0101"
S_BOX5["010011"] = "0000"
S_BOX5["010101"] = "1111"
S_BOX5["010111"] = "1010"
S_BOX5["011001"] = "0011"
S_BOX5["011011"] = "1001"
S_BOX5["011101"] = "1000"
S_BOX5["011111"] = "0110"

S_BOX5["100000"] = "0100"
S_BOX5["100010"] = "0010"
S_BOX5["100100"] = "0001"
S_BOX5["100110"] = "1011"
S_BOX5["101000"] = "1010"
S_BOX5["101010"] = "1101"
S_BOX5["101100"] = "0111"
S_BOX5["101110"] = "1000"
S_BOX5["110000"] = "1111"
S_BOX5["110010"] = "1001"
S_BOX5["110100"] = "1100"
S_BOX5["110110"] = "0101"
S_BOX5["111000"] = "0110"
S_BOX5["111010"] = "0011"
S_BOX5["111100"] = "0000"
S_BOX5["111110"] = "1110"

S_BOX5["100001"] = "1011"
S_BOX5["100011"] = "1000"
S_BOX5["100101"] = "1100"
S_BOX5["100111"] = "0111"
S_BOX5["101001"] = "0001"
S_BOX5["101011"] = "1110"
S_BOX5["101101"] = "0010"
S_BOX5["101111"] = "1101"
S_BOX5["110001"] = "0110"
S_BOX5["110011"] = "1111"
S_BOX5["110101"] = "0000"
S_BOX5["110111"] = "1001"
S_BOX5["111001"] = "1010"
S_BOX5["111011"] = "0100"
S_BOX5["111101"] = "0101"
S_BOX5["111111"] = "0011"

S_BOX6 = {}
S_BOX6["000000"] = "1100"
S_BOX6["000010"] = "0001"
S_BOX6["000100"] = "1010"
S_BOX6["000110"] = "1111"
S_BOX6["001000"] = "1001"
S_BOX6["001010"] = "0010"
S_BOX6["001100"] = "0110"
S_BOX6["001110"] = "1000"
S_BOX6["010000"] = "0000"
S_BOX6["010010"] = "1101"
S_BOX6["010100"] = "0011"
S_BOX6["010110"] = "0100"
S_BOX6["011000"] = "1110"
S_BOX6["011010"] = "0111"
S_BOX6["011100"] = "0101"
S_BOX6["011110"] = "1011"

S_BOX6["000001"] = "1010"
S_BOX6["000011"] = "1111"
S_BOX6["000101"] = "0100"
S_BOX6["000111"] = "0010"
S_BOX6["001001"] = "0111"
S_BOX6["001011"] = "1100"
S_BOX6["001101"] = "1001"
S_BOX6["001111"] = "0101"
S_BOX6["010001"] = "0110"
S_BOX6["010011"] = "0001"
S_BOX6["010101"] = "1101"
S_BOX6["010111"] = "1110"
S_BOX6["011001"] = "0000"
S_BOX6["011011"] = "1011"
S_BOX6["011101"] = "0011"
S_BOX6["011111"] = "1000"

S_BOX6["100000"] = "1001"
S_BOX6["100010"] = "1110"
S_BOX6["100100"] = "1111"
S_BOX6["100110"] = "0101"
S_BOX6["101000"] = "0010"
S_BOX6["101010"] = "1000"
S_BOX6["101100"] = "1100"
S_BOX6["101110"] = "0011"
S_BOX6["110000"] = "0111"
S_BOX6["110010"] = "0000"
S_BOX6["110100"] = "0100"
S_BOX6["110110"] = "1010"
S_BOX6["111000"] = "0001"
S_BOX6["111010"] = "1101"
S_BOX6["111100"] = "1011"
S_BOX6["111110"] = "0110"

S_BOX6["100001"] = "0100"
S_BOX6["100011"] = "0011"
S_BOX6["100101"] = "0010"
S_BOX6["100111"] = "1100"
S_BOX6["101001"] = "1001"
S_BOX6["101011"] = "0101"
S_BOX6["101101"] = "1111"
S_BOX6["101111"] = "1010"
S_BOX6["110001"] = "1011"
S_BOX6["110011"] = "1110"
S_BOX6["110101"] = "0001"
S_BOX6["110111"] = "0111"
S_BOX6["111001"] = "0110"
S_BOX6["111011"] = "0000"
S_BOX6["111101"] = "1000"
S_BOX6["111111"] = "1101"

S_BOX7 = {}
S_BOX7["000000"] = "0100"
S_BOX7["000010"] = "1011"
S_BOX7["000100"] = "0010"
S_BOX7["000110"] = "1110"
S_BOX7["001000"] = "1111"
S_BOX7["001010"] = "0000"
S_BOX7["001100"] = "1000"
S_BOX7["001110"] = "1101"
S_BOX7["010000"] = "0011"
S_BOX7["010010"] = "1100"
S_BOX7["010100"] = "1001"
S_BOX7["010110"] = "0111"
S_BOX7["011000"] = "0101"
S_BOX7["011010"] = "1010"
S_BOX7["011100"] = "0110"
S_BOX7["011110"] = "0001"

S_BOX7["000001"] = "1101"
S_BOX7["000011"] = "0000"
S_BOX7["000101"] = "1011"
S_BOX7["000111"] = "0111"
S_BOX7["001001"] = "0100"
S_BOX7["001011"] = "1001"
S_BOX7["001101"] = "0001"
S_BOX7["001111"] = "1010"
S_BOX7["010001"] = "1110"
S_BOX7["010011"] = "0011"
S_BOX7["010101"] = "0101"
S_BOX7["010111"] = "1100"
S_BOX7["011001"] = "0010"
S_BOX7["011011"] = "1111"
S_BOX7["011101"] = "1000"
S_BOX7["011111"] = "0110"

S_BOX7["100000"] = "0001"
S_BOX7["100010"] = "0100"
S_BOX7["100100"] = "1011"
S_BOX7["100110"] = "1101"
S_BOX7["101000"] = "1100"
S_BOX7["101010"] = "0011"
S_BOX7["101100"] = "0111"
S_BOX7["101110"] = "1110"
S_BOX7["110000"] = "1010"
S_BOX7["110010"] = "1111"
S_BOX7["110100"] = "0110"
S_BOX7["110110"] = "1000"
S_BOX7["111000"] = "0000"
S_BOX7["111010"] = "0101"
S_BOX7["111100"] = "1001"
S_BOX7["111110"] = "0010"

S_BOX7["100001"] = "0110"
S_BOX7["100011"] = "101"
S_BOX7["100111"] = "1000"
S_BOX7["101001"] = "0001"
S_BOX7["101011"] = "0100"
S_BOX7["101101"] = "1010"
S_BOX7["101111"] = "0111"
S_BOX7["110001"] = "1001"
S_BOX7["110011"] = "0101"
S_BOX7["110101"] = "0000"
S_BOX7["110111"] = "1111"
S_BOX7["111001"] = "1110"
S_BOX7["111011"] = "0010"
S_BOX7["111101"] = "0011"
S_BOX7["111111"] = "1100"



S_BOX8 = {}
S_BOX8["000000"] = "1101"
S_BOX8["000010"] = "0010"
S_BOX8["000100"] = "1000"
S_BOX8["000110"] = "0100"
S_BOX8["001000"] = "0110"
S_BOX8["001010"] = "1111"
S_BOX8["001100"] = "1011"
S_BOX8["001110"] = "0001"
S_BOX8["010000"] = "1010"
S_BOX8["010010"] = "1001"
S_BOX8["010100"] = "0011"
S_BOX8["010110"] = "1110"
S_BOX8["011000"] = "0101"
S_BOX8["011010"] = "0000"
S_BOX8["011100"] = "1100"
S_BOX8["011110"] = "0111"

S_BOX8["000001"] = "0001"
S_BOX8["000011"] = "1111"
S_BOX8["000101"] = "1101"
S_BOX8["000111"] = "1000"
S_BOX8["001001"] = "1010"
S_BOX8["001011"] = "0011"
S_BOX8["001101"] = "0111"
S_BOX8["001111"] = "0100"
S_BOX8["010001"] = "1100"
S_BOX8["010011"] = "0101"
S_BOX8["010101"] = "0110"
S_BOX8["010111"] = "1011"
S_BOX8["011001"] = "0000"
S_BOX8["011011"] = "1110"
S_BOX8["011101"] = "1001"
S_BOX8["011111"] = "0010"

S_BOX8["100000"] = "0111"
S_BOX8["100010"] = "1011"
S_BOX8["100100"] = "0100"
S_BOX8["100110"] = "0001"
S_BOX8["101000"] = "1001"
S_BOX8["101010"] = "1100"
S_BOX8["101100"] = "1110"
S_BOX8["101110"] = "0010"
S_BOX8["110000"] = "0000"
S_BOX8["110010"] = "0110"
S_BOX8["110100"] = "1010"
S_BOX8["110110"] = "1101"
S_BOX8["111000"] = "1111"
S_BOX8["111010"] = "0011"
S_BOX8["111100"] = "0101"
S_BOX8["111110"] = "1000"

S_BOX8["100001"] = "0010"
S_BOX8["100011"] = "0001"
S_BOX8["100101"] = "1110"
S_BOX8["100111"] = "0111"
S_BOX8["101001"] = "0100"
S_BOX8["101011"] = "1010"
S_BOX8["101101"] = "1000"
S_BOX8["101111"] = "1101"
S_BOX8["110001"] = "1111"
S_BOX8["110011"] = "1100"
S_BOX8["110101"] = "1001"
S_BOX8["110111"] = "0000"
S_BOX8["111001"] = "0011"
S_BOX8["111011"] = "0101"
S_BOX8["111101"] = "0110"
S_BOX8["111111"] = "1011"


def listaString(lista):
    string=""
    for i in lista:
        string= string+i
        
    return string

def permutation(codigo):
    lista= []
    lista.append(codigo[15])
    lista.append(codigo[6])
    lista.append(codigo[19])
    lista.append(codigo[20])
    lista.append(codigo[28])
    lista.append(codigo[11])
    lista.append(codigo[27])
    lista.append(codigo[16])
    lista.append(codigo[0])
    lista.append(codigo[14])
    lista.append(codigo[22])

    lista.append(codigo[25])
    lista.append(codigo[4])
    lista.append(codigo[17])
    lista.append(codigo[-2])
    lista.append(codigo[9])
    lista.append(codigo[1])
    lista.append(codigo[7])
    lista.append(codigo[23])
    lista.append(codigo[13])
    lista.append(codigo[-1])
    lista.append(codigo[26])
    lista.append(codigo[2])
    lista.append(codigo[8])
    lista.append(codigo[18])
    lista.append(codigo[12])
    lista.append(codigo[29])
    lista.append(codigo[5])
    lista.append(codigo[21])
    
    lista.append(codigo[10])
    lista.append(codigo[4])
    lista.append(codigo[24]) 
    
    string = listaString(lista)
    return string

# Expansion
def expansion(codigo):
    lista = []
    lista.append(codigo[27])
    for i in range(0,5,1):
        lista.append(codigo[i])
    for i in range(3,9,1):
        lista.append(codigo[i])
    for i in range(7,13,1):
        lista.append(codigo[i])        
    for i in range(11,17,1):
        lista.append(codigo[i]) 
    for i in range(15,21,1):
        lista.append(codigo[i])
    for i in range(19,25,1):
            lista.append(codigo[i])
    for i in range(23,29,1):
            lista.append(codigo[i])
    for i in range(27,30,1):
            lista.append(codigo[i]) 
    lista.append(codigo[-2])        
    lista.append(codigo[-1])        
    lista.append(codigo[0])
    
    string = listaString(lista)
    return string

# Funcion para la sustitucion de las S-BOX
def s_box(rxor):
    sbox1 = rxor[0:6]
    sbox2 = rxor[6:12]
    sbox3 = rxor[12:18]
    sbox4 = rxor[18:24]
    sbox5 = rxor[24:30]
    sbox6 = rxor[30:36]
    sbox7 = rxor[36:42]
    sbox8 = rxor[42:48]

    for i in S_BOX1:
        if sbox1 == i:
            sbox1 = S_BOX1[i]

    for i in S_BOX2:
        if sbox2 == i:
            sbox2 = S_BOX2[i]

    for i in S_BOX3:
        if sbox3 == i:
            sbox3 = S_BOX3[i]
    
    for i in S_BOX4:
        if sbox4 == i:
            sbox4 = S_BOX4[i]

    for i in S_BOX5:
        if sbox5 == i:
            sbox5 = S_BOX5[i]

    for i in S_BOX6:
        if sbox6 == i:
            sbox6 = S_BOX6[i]

    for i in S_BOX7:
        if sbox7 == i:
            sbox7 = S_BOX7[i]
    
    for i in S_BOX8:
        if sbox8 == i:
            sbox8 = S_BOX8[i]

    message_sbox = sbox1 + sbox2 + sbox3 + sbox4 + sbox5 + sbox6 + sbox7 + sbox8

    return message_sbox


def xor(lr, fk):
    xor_string = ""
    for i in range(len(lr)):
        if lr[i] == fk[i]:
            xor_string = xor_string + "0"
        else:
            xor_string = xor_string + "1"
            
    return xor_string

def f(r, k):
    rexpansion = expansion(r)
    print("esta es expansion ", rexpansion)
    xorf = xor(rexpansion, k)
    print("esta es el xor ", xorf)
    sbox = s_box(xorf)
    print("esta es el sbox ", sbox)
    listsbox = list(sbox)
    perm = permutation(listsbox)
    return perm

# Algoritmo DES
def DES(k, message):
    # Dividir el mensaje en dos bloques
    l = message[0:32]
    r = message[32:64]
    r2 = r
    # Ingresar en la funcion f, el bloque derecho y la llave
    ff = f(r, k)
    
    # Aplicar el XOR al bloque izquierdo y al resultado de la funcion f
    lf = xor(l, ff)

    # Dejar en el lado izquierdo el bloque derecho, y en el lado derecho el bloque izquierdo
    l = r2
    r = lf
    print("Round 1: ", l, r)
    
    # Combinamos el bloque izquierdo y el derecho
    combine_blocks = r + l
    
    return combine_blocks

def DES_desencrypt(k, txtcipher):
    # Dividir el texto cifrado en dos bloques de 32 bits
    r = txtcipher[0:32]
    l = txtcipher[32:64]
    r2 = r
    # Ingresa el bloque derecho y la llave a la funcion f
    ff = f(r, k)

    # Aplicar el XOR al bloque izquierdo y al resultado de la funcion f
    lf = xor(l, ff)

    # Dejar el lado izquierdo en el bloque derecho, y el lado derecho en el bloque izquierdo
    l = r2
    r = lf
    print("\nRound 1: ", l, r)

    # Combinamos el bloque izquiedo con el derecho
    combine_blocks = r + l

    return combine_blocks

print("Bienvenido a DES\n Que desea realiar? \n 1) Encriptar \n 2) Desencriptar")
op = input("Escoja una opci√≥n: ")
if op == "1":
    txt = input("Escriba el mensaje para encriptar: ")
    k = input("Escriba una llave: ")
    des = DES(k, txt)
    print("\n", des)
elif op == "2":
    txt = input("Escriba el mensaje para desencriptar: ")
    k = input("Escriba una llave: ")
    desreverse = DES(k, txt)
    print("\n", desreverse)
